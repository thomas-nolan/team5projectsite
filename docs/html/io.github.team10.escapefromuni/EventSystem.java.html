<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>EventSystem.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">core</a> &gt; <a href="index.source.html" class="el_package">io.github.team10.escapefromuni</a> &gt; <span class="el_source">EventSystem.java</span></div><h1>EventSystem.java</h1><pre class="source lang-java linenums">package io.github.team10.escapefromuni;

import java.util.EnumMap;
import java.util.Map;

/**
 * NEW FOR ASSESSMENT 2.
 * This class handles the logic for starting events, rendering event
 * related content and tracking events across the game.
 */
public class EventSystem {

  private IEvent activeEvent;

  // NEW FOR ASSESSMENT 2 - Used to track the events
<span class="fc" id="L16">  private final Map&lt;EventType, Integer&gt; triggeredCounts = new EnumMap&lt;&gt;(EventType.class);</span>
<span class="fc" id="L17">  private final Map&lt;EventType, Integer&gt; maxCounts = new EnumMap&lt;&gt;(EventType.class);</span>

  /**
   * NEW FOR ASSESSMENT 2.
   * This constructor creates a new EventSystem and sets up
   * the events. It also sets up the event counter
   */
<span class="fc" id="L24">  public EventSystem() {</span>

    // NEW FOR ASSESSMENT 2 - Initialises the event counter
<span class="fc bfc" id="L27" title="All 2 branches covered.">    for (EventType type : EventType.values()) {</span>
<span class="fc" id="L28">      triggeredCounts.put(type, 0);</span>
    }

    // NEW FOR ASSESSMENT 2
    // Sets the number of events for each type in the event counter
<span class="fc" id="L33">    maxCounts.put(EventType.NEGATIVE, 5);</span>
<span class="fc" id="L34">    maxCounts.put(EventType.POSITIVE, 4);</span>
<span class="fc" id="L35">    maxCounts.put(EventType.HIDDEN, 3);</span>
<span class="fc" id="L36">  }</span>

  /**
   * This activates the event upon entering the room.
   *
   * @param room the {@link Room} object you enter
   */
  public void onEnterRoom(Room room) {
<span class="fc" id="L44">    activeEvent = room.getEvent();</span>

<span class="pc bpc" id="L46" title="1 of 2 branches missed.">    if (activeEvent != null) {</span>
<span class="fc" id="L47">      activeEvent.startEvent();</span>
    }
<span class="fc" id="L49">  }</span>

  /**
   * Finishes the event upon exiting the room.
   *
   * @param room the {@link Room} object you leave
   */
  public void onExitRoom(Room room) {
<span class="pc bpc" id="L57" title="1 of 2 branches missed.">    if (activeEvent != null) {</span>
<span class="fc" id="L58">      activeEvent = null;</span>
    }
<span class="fc" id="L60">  }</span>

  /**
   * Updates the logic for the event upon every frame.
   *
   * @param delta the time between each frame
   */
  public void update(float delta) {
<span class="pc bpc" id="L68" title="1 of 2 branches missed.">    if (activeEvent != null) {</span>
<span class="nc" id="L69">      activeEvent.update(delta);</span>
    }
<span class="fc" id="L71">  }</span>

  /**
   * This renders the world visuals for the active event.
   */
  public void drawWorld() {
<span class="pc bpc" id="L77" title="1 of 2 branches missed.">    if (activeEvent != null) {</span>
<span class="fc" id="L78">      activeEvent.draw();</span>
    }
<span class="fc" id="L80">  }</span>

  /**
   * This method draws the UI for the active event.
   */
  public void drawUI() {
<span class="pc bpc" id="L86" title="1 of 2 branches missed.">    if (activeEvent != null) {</span>
<span class="fc" id="L87">      activeEvent.drawUI();</span>
    }
<span class="fc" id="L89">  }</span>

  /**
   * NEW FOR ASSESSMENT 2.
   * This method used for the event counter, registering an event
   * if it is interacted with.
   *
   * @param type the type of event
   */
  public void registerEvent(EventType type) {
<span class="fc bfc" id="L99" title="All 2 branches covered.">    if (type == EventType.NONE) {</span>
<span class="fc" id="L100">      return;</span>
    }

    // NEW FOR ASSESSMENT 2 - Gets the current event type and the max number of that type
<span class="fc" id="L104">    int current = triggeredCounts.get(type);</span>
<span class="fc" id="L105">    int max = maxCounts.get(type);</span>

    // NEW FOR ASSESSMENT 2 - If the max hasn't been excided add the event to the counter
<span class="fc bfc" id="L108" title="All 2 branches covered.">    if (current &lt; max) {</span>
<span class="fc" id="L109">      triggeredCounts.put(type, current + 1);</span>
    }

<span class="fc" id="L112">  }</span>

  /**
   * NEW FOR ASSESSMENT 2.
   * This returns the number of times an event type has been triggered.
   *
   * @param type type of the event
   * @return the number of times an event has been triggered
   */
  public int getTriggered(EventType type) {
<span class="fc" id="L122">    return triggeredCounts.getOrDefault(type, 0);</span>
  }

  /**
   * NEW FOR ASSESSMENT 2.
   * Returns the max number of times an event type may be triggered
   *
   * @param type the type of event
   * @return the max number of times an event type may be triggered
   */
  public int getMax(EventType type) {
<span class="fc" id="L133">    return maxCounts.getOrDefault(type, 0);</span>
  }

  /**
   * NEW FOR ASSESSMENT 2.
   * Resets the events counter
   */
  public void reset() {
<span class="fc bfc" id="L141" title="All 2 branches covered.">    for (EventType type : EventType.values()) {</span>
<span class="fc" id="L142">      triggeredCounts.put(type, 0);</span>
    }
<span class="fc" id="L144">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.13.202504020838</span></div></body></html>